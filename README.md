# AUKCAT-Data-Selection-Pipeline

AUKCAT-Data-Selection-Pipeline is an iterative data-selection procedure that filters high-confidence pseudo-instances from the CVAE-generated data pool and incrementally integrates them to expand the augmented dataset.
<img width="2240" height="1227" alt="image" src="https://github.com/user-attachments/assets/048eb9ad-e0ce-42c4-abd9-653d0614d4cc" />


## Dependencies
## Dependencies
1. pytorch 1.10.0
2. pandas 1.4.2
3. numpy 1.24.3
4. sklearn 1.0.2
5. scipy 1.5.3
6. CUDA 11.1


## Pipeline Inputs
The AUKCAT-Data-Selection-Pipeline uses the following inputs to iteratively select high-confidence pseudo instances and expand the augmented training dataset:
### 1. Original Dataset
The original dataset consists of substrate–EC number–species triples paired with experimentally measured kcat values. Substrates are embedded using [Mol2Vec](https://github.com/samoturk/mol2vec), EC numbers via [EC2Vec](https://github.com/MengLiu90/EC2Vec), and species via Node2Vec.

The file ```./Datasets/Original_data.csv``` contains all original instances used in the data selection pipeline. The file ```./Datasets/example_data.csv``` contains example data after embedding.

### 2.Pseudo Dataset Generated by AUKCAT-CVAE
The Pseudo instances generated by the CVAE includes: 
(1) Matching features (mol2vec, ec2vec, species embedding)
(2) pseudo kcat: kcat value predicted by CVAE + kNN
(3) source_index: index of the original sample this pseudo instance was originated from

```./Datasets/Pseudo_data.csv``` contains example data generated by AUKCAT-CVAE.

## Pseudo-Instance Selection and Dataset Augmentation
To iteratively select the high-confidence pseudo instances and get expanded training dataset, run ```Data_selection_script.py```

The selected synthetic instances from each round are saved in the output directory ```pseudo_selection_outputs_20r_tolorance```

Note: ```Data_selection_script.py``` invokes the CVAE data generation script ```CVAE_data_generation.py``` via ```subprocess.run()``` in each round to dynamically generate fresh pseudo samples using a pre-trained AUKCAT-CVAE model.
